<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Upload Test</title>
</head>
<body>
  <h1>Upload Test</h1>
  <form id="uploadForm">
    <input name="fileToUpload" type="file">
    <button>Upload</button>
  </form>
  <script src="../tozny-sodium.dev.js"></script>
  <script>
    const form = document.getElementById('uploadForm')
    const creds = {
      "version": "2",
      "public_signing_key": "A9fKJLgOsm8j2_Z4lKmpXxOBhiKQ7qjK9KAHDblb8j4",
      "private_signing_key": "eVkzJNf31x505-MtA7-z-jwJASycFW8eAbGkuU-H5Z8D18okuA6ybyPb9niUqalfE4GGIpDuqMr0oAcNuVvyPg",
      "client_id": "3ac47591-be5f-4e2a-a54e-8d1c3509fe79",
      "api_key_id": "f6d08df1e4491e89e268e834a7b7a4f901a6ef760db8618af52b1eebaba81f54",
      "api_secret": "1fdda2e6ce04852de6144d62e92bd525f362f9118bf5be839b0ea4d84ba5fd68",
      "public_key": "F6oSdtdyr5cYVcAD_nOMg0ZyO2Urb1eMhbdiGNvfLik",
      "private_key": "6BnUBrnDMbQPkfOyXQQ8M6bgBDOSPfyAeq54ZadPuqA",
      "api_url": "http://platform.local.tozny.com:8000",
      "client_email": ""
    }
    const client = new Tozny.storage.Client(Tozny.storage.Config.fromObject(creds))
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      const formData = new FormData(form)
      const selectedFile = formData.get('fileToUpload')
      async function upload(blob) {
        try {
          const file = await client.writeFile('test-file', blob, {test: 'meta'})
          console.log(file)
        } catch(e) {
          console.error(e)
        }
      }
      upload(selectedFile)
    })
  </script>
</body>
</html>
